<VirtualHost *:80>
    DocumentRoot "/var/www/localhost/htdocs"
    ServerName {WEBSITES_HOST}

    <Location />
        # Password protect using basic authentication
        AuthType Basic
        AuthBasicProvider file
        AuthUserFile "/etc/apache2/.htpasswd"
        AuthName "Authentication required"

        <RequireAll>
            # Only allow requests to originate from web apps in our hosting plan using private network
            Require ip 172.0.0.0/8

            # Also require valid user
            Require valid-user
        </RequireAll>

        # Proxy to solr instance
        ProxyPass http://localhost:8983/
        ProxyPassReverse http://localhost:8983/
    </Location>
</VirtualHost>
