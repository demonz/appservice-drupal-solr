<VirtualHost *:80>
    DocumentRoot "/var/www/localhost/htdocs"
    ServerName {WEBSITES_HOST}

    <Location />
        # Password protect using basic authentication
        AuthType Basic
        AuthBasicProvider file
        AuthUserFile "/etc/apache2/.htpasswd"
        AuthName "Authentication required"

        <RequireAll>
            # Access control, only allow requests to originate from the drupal instance
            # Require ip defined as application setting
            {WEBSITES_REQUIRE_IP}
            # End Require

            # Also require valid user
            Require valid-user
        </RequireAll>

        # Proxy to solr instance
        ProxyPass http://localhost:8983/
        ProxyPassReverse http://localhost:8983/
    </Location>
</VirtualHost>
